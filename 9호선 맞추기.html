<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€í•˜ì²  ì²™ì²™ë°•ì‚¬ë‹˜ (1í˜¸ì„  & 9í˜¸ì„ )</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');
        
        body {
            font-family: 'Jua', sans-serif;
            background-color: #FFF8E1;
            text-align: center;
            margin: 0;
            padding: 10px;
            user-select: none;
        }

        /* ì‹œì‘ í™”ë©´ ìŠ¤íƒ€ì¼ */
        #start-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: #fff;
        }

        .menu-btn {
            width: 280px;
            padding: 20px;
            margin: 15px;
            font-size: 24px;
            font-family: 'Jua', sans-serif;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 5px 10px rgba(0,0,0,0.2);
            transition: transform 0.2s;
            color: white;
            font-weight: bold;
        }
        .menu-btn:hover { transform: scale(1.05); }
        .btn-line1 { background-color: #0052A4; } /* 1í˜¸ì„  ë‚¨ìƒ‰ */
        .btn-line9 { background-color: #AA9872; } /* 9í˜¸ì„  ê¸ˆìƒ‰ */

        /* ê²Œì„ í™”ë©´ í—¤ë” */
        header {
            display: none; /* ê²Œì„ ì‹œì‘ ì „ì—” ìˆ¨ê¹€ */
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: white;
            border-radius: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        #game-title { margin: 0; font-size: 22px; }
        #score-board { font-size: 20px; color: #FF8F00; }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .container {
            display: none; /* ê²Œì„ ì‹œì‘ ì „ì—” ìˆ¨ê¹€ */
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            max-width: 900px;
            margin: 0 auto;
        }

        .left-panel { flex: 1; min-width: 300px; }
        .right-panel { flex: 0.8; min-width: 280px; }

        /* ë…¸ì„ ë„ */
        #map-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            gap: 6px;
            padding: 15px;
            background: white;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid #eee;
        }

        .station-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 45px;
        }

        .station-dot {
            width: 12px;
            height: 12px;
            background-color: #ddd;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .station-dot.active { transform: scale(1.4); box-shadow: 0 0 8px currentColor; }
        
        .station-name {
            font-size: 10px;
            margin-top: 5px;
            visibility: hidden;
            text-align: center;
            word-break: keep-all;
        }
        .station-name.revealed { visibility: visible; }

        .transfer-badges { display: flex; gap: 2px; justify-content: center; margin-top: 2px; }
        .line-badge { width: 6px; height: 6px; border-radius: 50%; display: inline-block; }

        /* ê²Œì„ ë°•ìŠ¤ */
        #game-area {
            background-color: white;
            border-radius: 20px;
            padding: 20px;
            border: 4px solid #ddd; /* JSì—ì„œ ìƒ‰ìƒ ë³€ê²½ */
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        #current-station {
            font-size: 28px;
            font-weight: bold;
            margin: 10px 0;
            padding: 10px;
            background-color: #fff9e6;
            border-radius: 10px;
        }

        /* ë³´ê¸° ë²„íŠ¼ */
        .option-btn {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            font-size: 19px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            background-color: #f7fafc;
            color: #444;
            cursor: pointer;
            font-family: 'Jua', sans-serif;
            position: relative;
        }
        .option-btn:hover { background-color: #edf2f7; }
        .btn-num {
            background-color: #888;
            color: white;
            width: 28px; height: 28px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            margin-right: 15px; font-size: 16px;
        }

        /* ì˜¤ë‹µ í”¼ë“œë°± í…ìŠ¤íŠ¸ (ëª‡í˜¸ì„ ì¸ì§€) */
        .wrong-feedback {
            font-size: 14px;
            color: #e53e3e;
            margin-left: auto;
            font-weight: bold;
        }

        /* ì„¤ëª… ì¹´ë“œ */
        #info-card {
            background-color: #FFF;
            border-radius: 20px;
            padding: 25px;
            border: 4px solid #FFAB91;
            text-align: left;
        }
        #info-title { font-size: 24px; color: #D84315; margin-bottom: 15px; border-bottom: 2px dashed #FFCCBC; padding-bottom: 10px;}
        #info-text { font-size: 20px; color: #555; line-height: 1.5; }

        /* ìƒíƒœ ë©”ì‹œì§€ */
        #message { height: 30px; font-size: 20px; font-weight: bold; margin-top: 10px; }
        .correct { color: #2E7D32; } .wrong { color: #C62828; }

        #success-screen { display: none; }
        .nav-btn { background-color: #555; color: white; padding: 10px 20px; border: none; border-radius: 20px; font-size: 18px; margin-top: 10px; cursor: pointer;}
        
        /* íŒíŠ¸ ì• ë‹ˆë©”ì´ì…˜ */
        .hint-active { background-color: #b2f5ea !important; animation: shake 0.5s infinite; }
        @keyframes shake { 0%, 100% {transform:translateX(0);} 25% {transform:translateX(-5px);} 75% {transform:translateX(5px);} }

    </style>
</head>
<body>

    <div id="start-screen">
        <h1 style="font-size: 40px; margin-bottom: 30px;">ğŸš‚ ì§€í•˜ì²  ì²™ì²™ë°•ì‚¬ë‹˜</h1>
        <p style="font-size: 20px; margin-bottom: 30px;">ì–´ë–¤ ë…¸ì„ ì„ ì™¸ì›Œë³¼ê¹Œìš”?</p>
        
        <button class="menu-btn btn-line1" onclick="selectLine('1')">ğŸŸ¦ 1í˜¸ì„  (ì„œìš¸ì—­ â¡ ì¸ì²œ)</button>
        <button class="menu-btn btn-line9" onclick="selectLine('9')">ğŸŸ¨ 9í˜¸ì„  (ì¤‘ì•™ë³´í›ˆ â¡ ê°œí™”)</button>
    </div>

    <header id="game-header">
        <h1 id="game-title">ë…¸ì„  ì´ë¦„</h1>
        <div id="score-board">â­ ë§ì¶˜ ê°œìˆ˜: 0ê°œ</div>
    </header>

    <div class="container" id="game-container">
        <div class="left-panel">
            <div id="map-container"></div>

            <div id="game-area">
                <div id="play-screen">
                    <div style="font-size:16px; color:#888;">ì§€ê¸ˆ ì—­ì€?</div>
                    <div id="current-station">ì¶œë°œì—­</div>
                    <div class="arrow" style="font-size: 20px; color:#aaa; margin:10px 0;">â¬‡ï¸ ë‹¤ìŒ ì—­ì€ ì–´ë””ì¼ê¹Œìš”? â¬‡ï¸</div>
                    
                    <div id="options-container"></div>
                    <div id="message"></div>
                </div>

                <div id="success-screen">
                    <h2 style="font-size:30px;">ğŸ‰ ë„ì°©! ğŸ‰</h2>
                    <p id="success-msg">ì¢…ì ì— ë„ì°©í–ˆì–´ìš”!</p>
                    <button class="nav-btn" onclick="location.reload()">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
                </div>
            </div>
        </div>

        <div class="right-panel">
            <div id="info-card">
                <div id="info-title">ì—­ ì´ì•¼ê¸° ğŸ“–</div>
                <div id="info-text">
                    ì•ˆë…•? ë‚˜ëŠ” ì„¤ëª… ìš”ì •ì´ì•¼.<br>
                    ë¬¸ì œë¥¼ ë§ì¶”ë©´ ë‚´ê°€ ì¬ë¯¸ìˆëŠ” ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì¤„ê²Œ!
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- ë°ì´í„° ì˜ì—­ ---

        // ë…¸ì„ ë³„ ìƒ‰ìƒ
        const lineColors = {
            "1": "#0052A4", "2": "#009D3E", "3": "#EF7C1C", "4": "#0052A4", 
            "5": "#996CAC", "6": "#CD7C2F", "7": "#747F00", "8": "#E6186C", "9": "#AA9872",
            "ë¶„ë‹¹": "#F5A200", "ì‹ ë¶„ë‹¹": "#D4003B", "ê³µí•­": "#0090D2", 
            "ì‹ ë¦¼": "#6789CA", "ì„œí•´": "#81A914", "ì¸ì²œ1": "#7CA8D5", "ìˆ˜ì¸ë¶„ë‹¹": "#F5A200"
        };

        // ì˜¤ë‹µìš© ë‹¤ë¥¸ í˜¸ì„  ì—­ ì •ë³´ (ì´ë¦„: í˜¸ì„ )
        const otherStationsDB = {
            "ê°•ë‚¨": "2í˜¸ì„ ", "ì ì‹¤": "2í˜¸ì„ ", "í™ëŒ€ì…êµ¬": "2í˜¸ì„ ", "ì‹ ë„ë¦¼": "1,2í˜¸ì„ ", "ì‚¬ë‹¹": "2,4í˜¸ì„ ",
            "ì„ì§€ë¡œì…êµ¬": "2í˜¸ì„ ", "ì„±ìˆ˜": "2í˜¸ì„ ", "ì••êµ¬ì •": "3í˜¸ì„ ", "ì‹ ì‚¬": "3í˜¸ì„ ", "ì–‘ì¬": "3í˜¸ì„ ",
            "ëª…ë™": "4í˜¸ì„ ", "ë™ëŒ€ë¬¸": "1,4í˜¸ì„ ", "í˜œí™”": "4í˜¸ì„ ", "ì´íƒœì›": "6í˜¸ì„ ", "ìƒìˆ˜": "6í˜¸ì„ ",
            "ê±´ëŒ€ì…êµ¬": "2,7í˜¸ì„ ", "ê´‘í™”ë¬¸": "5í˜¸ì„ ", "ì²œí˜¸": "5,8í˜¸ì„ ", "ìˆ˜ì„œ": "3,ìˆ˜ì¸ë¶„ë‹¹", "íŒêµ": "ì‹ ë¶„ë‹¹"
        };

        // ê²Œì„ ë°ì´í„° (1í˜¸ì„ , 9í˜¸ì„ )
        const gameData = {
            "1": {
                name: "1í˜¸ì„  (ì„œìš¸ì—­ â¡ ì¸ì²œ)",
                mainColor: "#0052A4",
                stations: [
                    { name: "ì„œìš¸ì—­", trans: ["4", "ê³µí•­"], desc: "ìš°ë¦¬ë‚˜ë¼ì—ì„œ ì œì¼ í° ê¸°ì°¨ì—­ì´ì•¼! KTX ì¹™ì¹™í­í­! ğŸš„" },
                    { name: "ë‚¨ì˜", trans: [], desc: "ì—¬ê¸°ì—” ë§›ìˆëŠ” ìŠ¤í…Œì´í¬ ê³¨ëª©ì´ ìˆëŒ€. ğŸ¥©" },
                    { name: "ìš©ì‚°", trans: ["ê²½ì˜ì¤‘ì•™"], desc: "ë¡œë´‡ì´ë‘ ì»´í“¨í„°ë¥¼ íŒŒëŠ” ì „ììƒê°€ê°€ ìˆì–´! ğŸ¤–" },
                    { name: "ë…¸ëŸ‰ì§„", trans: ["9"], desc: "í„ë–¡í„ë–¡ ë¬¼ê³ ê¸°ê°€ ìˆëŠ” ìˆ˜ì‚°ì‹œì¥! ğŸŸ" },
                    { name: "ëŒ€ë°©", trans: ["ì‹ ë¦¼"], desc: "ì—¬ì˜ë„ë¡œ ë“¤ì–´ê°€ëŠ” ì…êµ¬ì•¼. ğŸ¢" },
                    { name: "ì‹ ê¸¸", trans: ["5"], desc: "ë§¤ìš´ ì§¬ë½•ì´ ì•„ì£¼ ìœ ëª…í•œ ë™ë„¤ì•¼. ğŸœ" },
                    { name: "ì˜ë“±í¬", trans: [], desc: "ê¸°ì°¨ë„ ì„œê³ , ë°±í™”ì ë„ ìˆëŠ” í° ì—­ì´ì•¼. ğŸ›ï¸" },
                    { name: "ì‹ ë„ë¦¼", trans: ["2"], desc: "ì‚¬ëŒë“¤ì´ ì •ë§ ë§ì´ ê°ˆì•„íƒ€ëŠ” ì—­ì´ì•¼. ë¶ì ë¶ì ! ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" },
                    { name: "êµ¬ë¡œ", trans: [], desc: "ì—¬ê¸°ì„œ ì¸ì²œ ê°€ëŠ” ê¸°ì°¨ë‘ ìˆ˜ì› ê°€ëŠ” ê¸°ì°¨ê°€ ê°ˆë¼ì ¸! ğŸ›¤ï¸" },
                    { name: "êµ¬ì¼", trans: [], desc: "ê³ ì²™ìŠ¤ì¹´ì´ë” ì•¼êµ¬ì¥ì´ ë°”ë¡œ ë³´ì—¬! âš¾" },
                    { name: "ê°œë´‰", trans: [], desc: "ì¬ë¯¸ìˆëŠ” ì˜í™”ê´€ì´ ìˆëŠ” ì—­ì´ì•¼. ğŸ¿" },
                    { name: "ì˜¤ë¥˜ë™", trans: [], desc: "ì˜ˆì „ì— ì£¼ë§‰ê±°ë¦¬ê°€ ìˆë˜ ê³³ì´ë˜. ğŸŒ³" },
                    { name: "ì˜¨ìˆ˜", trans: ["7"], desc: "7í˜¸ì„ ìœ¼ë¡œ ê°ˆì•„íƒ€ë©´ ê°•ë‚¨ìœ¼ë¡œ ê°ˆ ìˆ˜ ìˆì–´. ğŸš‡" },
                    { name: "ì—­ê³¡", trans: [], desc: "ì‹œì¥ì´ ê°€ê¹Œì›Œì„œ ì‚¬ëŒë“¤ì´ ë§ì•„. ğŸ" },
                    { name: "ì†Œì‚¬", trans: ["ì„œí•´"], desc: "ì•„ì£¼ ë§›ìˆëŠ” ë³µìˆ­ì•„ê°€ ìœ ëª…í–ˆë˜ ê³³ì´ë˜. ğŸ‘" },
                    { name: "ë¶€ì²œ", trans: [], desc: "í° ì´ë§ˆíŠ¸ë‘ ì—­ì´ ì—°ê²°ë˜ì–´ ìˆì–´. ğŸ›’" },
                    { name: "ì¤‘ë™", trans: [], desc: "ì•„íŒŒíŠ¸ê°€ ì•„ì£¼ ë§ì€ ë™ë„¤ì•¼. ğŸ¢" },
                    { name: "ì†¡ë‚´", trans: [], desc: "ì—¬ê¸°ì„œ ë²„ìŠ¤ íƒ€ë©´ ì˜í™” ê±°ë¦¬ì— ê°ˆ ìˆ˜ ìˆì–´. ğŸ¬" },
                    { name: "ë¶€ê°œ", trans: [], desc: "ì¡°ìš©í•˜ê³  ì‚´ê¸° ì¢‹ì€ ë™ë„¤ì•¼. ğŸ˜ï¸" },
                    { name: "ë¶€í‰", trans: ["ì¸ì²œ1"], desc: "ì§€í•˜ìƒê°€ê°€ ë¯¸ë¡œì²˜ëŸ¼ ì—„ì²­ ë„“ì–´! ê¸¸ ìƒì§€ ì•Šê²Œ ì¡°ì‹¬! ğŸ˜µ" },
                    { name: "ë°±ìš´", trans: [], desc: "í•˜ì–€ êµ¬ë¦„ì´ë¼ëŠ” ì˜ˆìœ ì´ë¦„ì´ì•¼. â˜ï¸" },
                    { name: "ë™ì•”", trans: [], desc: "ì‹­ì •ë™ì´ë¼ëŠ” ë§ˆì„ì´ ê·¼ì²˜ì— ìˆì–´. ğŸ•" },
                    { name: "ê°„ì„", trans: [], desc: "í° ë°”ìœ„ê°€ ìˆì—ˆë‹¤ê³  í•´ì„œ ê°„ì„ì´ë˜. ğŸª¨" },
                    { name: "ì£¼ì•ˆ", trans: ["ì¸ì²œ2"], desc: "ì¸ì²œ ì§€í•˜ì²  2í˜¸ì„ ìœ¼ë¡œ ê°ˆì•„íƒˆ ìˆ˜ ìˆì–´. ğŸš‰" },
                    { name: "ë„í™”", trans: [], desc: "ë³µìˆ­ì•„ ê½ƒì´ ë§ì´ í”¼ë˜ ë™ë„¤ë˜. ğŸŒ¸" },
                    { name: "ì œë¬¼í¬", trans: [], desc: "í•™êµë“¤ì´ ë§ì´ ëª¨ì—¬ìˆëŠ” ê³³ì´ì•¼. ğŸ«" },
                    { name: "ë„ì›", trans: [], desc: "ì¸ì²œ ì¶•êµ¬ ì „ìš© ê²½ê¸°ì¥ì´ ë°”ë¡œ ì˜†ì´ì•¼! âš½" },
                    { name: "ë™ì¸ì²œ", trans: [], desc: "ë§›ìˆëŠ” ë‹­ê°•ì •ì´ ìœ ëª…í•œ ì‹œì¥ì´ ìˆì–´! ğŸ—" },
                    { name: "ì¸ì²œ", trans: ["ìˆ˜ì¸ë¶„ë‹¹"], desc: "ë„ì°©! ì§œì¥ë©´ì´ íƒœì–´ë‚œ ì°¨ì´ë‚˜íƒ€ìš´ì´ ìˆì–´! ğŸ‡¨ğŸ‡³" }
                ]
            },
            "9": {
                name: "9í˜¸ì„  (ì¤‘ì•™ë³´í›ˆ â¡ ê°œí™”)",
                mainColor: "#AA9872",
                stations: [
                    { name: "ì¤‘ì•™ë³´í›ˆë³‘ì›", trans: [], desc: "ë‚˜ë¼ë¥¼ ì§€í‚¨ ì˜ì›…ë“¤ì„ ìœ„í•œ ë³‘ì›ì´ì•¼. ğŸ¥" },
                    { name: "ë‘”ì´Œì˜¤ë¥œ", trans: [], desc: "í° í•™êµê°€ ì˜†ì— ìˆì–´. ğŸ«" },
                    { name: "ì˜¬ë¦¼í”½ê³µì›", trans: ["5"], desc: "ê±°ëŒ€í•œ ì—„ì§€ì†ê°€ë½ ì¡°ê°ìƒì„ ì°¾ì•„ë´! ğŸ‘" },
                    { name: "í•œì„±ë°±ì œ", trans: [], desc: "ë°±ì œ ì‹œëŒ€ ë°•ë¬¼ê´€ì´ ìˆì–´. ğŸº" },
                    { name: "ì†¡íŒŒë‚˜ë£¨", trans: [], desc: "ì˜›ë‚ ì—” ë°°ê°€ ë‹¤ë‹ˆë˜ ê³³ì´ë˜. â›µ" },
                    { name: "ì„ì´Œ", trans: ["8"], desc: "ë¡¯ë°ì›”ë“œíƒ€ì›Œê°€ ìŠ~ í•˜ê³  ë³´ì—¬! ğŸ™ï¸" },
                    { name: "ì„ì´Œê³ ë¶„", trans: [], desc: "ì˜›ë‚  ì™•ë“¤ì˜ ë¬´ë¤ì´ ìˆì–´. ğŸ‘‘" },
                    { name: "ì‚¼ì „", trans: [], desc: "ì ì‹¤ì´ë‘ ê°€ê¹Œìš´ ë™ë„¤ì•¼. ğŸ " },
                    { name: "ì¢…í•©ìš´ë™ì¥", trans: ["2"], desc: "ì•¼êµ¬ì¥ì—ì„œ ì‘ì› ì†Œë¦¬ê°€ ë“¤ë ¤! âš¾" },
                    { name: "ë´‰ì€ì‚¬", trans: [], desc: "ë„ì‹¬ ì†ì— ì•„ì£¼ í° ì ˆì´ ìˆì–´. ğŸ¯" },
                    { name: "ì‚¼ì„±ì¤‘ì•™", trans: [], desc: "ì½”ì—‘ìŠ¤ë‘ ê°€ê¹Œì›Œ. ğŸ›ï¸" },
                    { name: "ì„ ì •ë¦‰", trans: ["ìˆ˜ì¸ë¶„ë‹¹"], desc: "ìˆ² ì†ì— ì™•ë¦‰ì´ ìˆ¨ì–´ìˆì–´. ğŸŒ³" },
                    { name: "ì–¸ì£¼", trans: [], desc: "ê°•ë‚¨ ì°¨ë³‘ì›ì´ ê·¼ì²˜ì— ìˆì–´. ğŸš‘" },
                    { name: "ì‹ ë…¼í˜„", trans: ["ì‹ ë¶„ë‹¹"], desc: "ê°•ë‚¨ì—ì„œ ì œì¼ ë³µì¡í•œ ê³³ ì¤‘ í•˜ë‚˜ì•¼! ğŸ¢" },
                    { name: "ì‚¬í‰", trans: [], desc: "ì¡°ìš©í•œ ì•„íŒŒíŠ¸ ë‹¨ì§€ì•¼. ğŸ˜ï¸" },
                    { name: "ê³ ì†í„°ë¯¸ë„", trans: ["3", "7"], desc: "ì—¬í–‰ ê°€ëŠ” ë²„ìŠ¤ë¥¼ íƒ€ëŠ” ê³³ì´ì•¼! ğŸšŒ" },
                    { name: "ì‹ ë°˜í¬", trans: [], desc: "í•œê°• ê³µì›ìœ¼ë¡œ ì‚°ì±… ê°€ì! ğŸŒŠ" },
                    { name: "êµ¬ë°˜í¬", trans: [], desc: "ì‘ì€ ëƒ‡ë¬¼ì´ íë¥´ëŠ” ê³³ì´ì•¼. ğŸ¦†" },
                    { name: "ë™ì‘", trans: ["4"], desc: "í˜„ì¶©ì›ì´ ìˆëŠ” ê³³ì´ì•¼. ğŸ‡°ğŸ‡·" },
                    { name: "í‘ì„", trans: [], desc: "ì¤‘ì•™ëŒ€í•™êµê°€ ìˆì–´. ğŸ“" },
                    { name: "ë…¸ë“¤", trans: [], desc: "í•œê°• ìœ„ì— ë–  ìˆëŠ” ì„¬ì´ì•¼! ğŸï¸" },
                    { name: "ë…¸ëŸ‰ì§„", trans: ["1"], desc: "ë§›ìˆëŠ” íšŒë¥¼ ë¨¹ìœ¼ëŸ¬ ê°€ì! ğŸŸ" },
                    { name: "ìƒ›ê°•", trans: ["ì‹ ë¦¼"], desc: "ì—¬ì˜ë„ ìƒ›ê°•ì— ì˜¤ë¦¬ë“¤ì´ ì‚´ì•„. ğŸ¦†" },
                    { name: "ì—¬ì˜ë„", trans: ["5"], desc: "ë”í˜„ëŒ€ ì„œìš¸ ë°±í™”ì ì´ ìˆì–´! ğŸ" },
                    { name: "êµ­íšŒì˜ì‚¬ë‹¹", trans: [], desc: "íƒœê¶ŒVê°€ ë‚˜ì˜¬ ê²ƒ ê°™ì€ ë‘¥ê·¼ ì§€ë¶• ê±´ë¬¼! ğŸ›ï¸" },
                    { name: "ë‹¹ì‚°", trans: ["2"], desc: "ì „ì²  íƒ€ê³  í•œê°• ë‹¤ë¦¬ë¥¼ ê±´ë„ˆë´! ğŸŒ‰" },
                    { name: "ì„ ìœ ë„", trans: [], desc: "ê³µì›ì´ ëœ ì˜›ë‚  ì •ìˆ˜ì¥ì´ì•¼. â›²" },
                    { name: "ì‹ ëª©ë™", trans: [], desc: "ìì „ê±° íƒ€ê¸° ì¢‹ì€ ì•ˆì–‘ì²œì´ ìˆì–´. ğŸš²" },
                    { name: "ì—¼ì°½", trans: [], desc: "ì˜›ë‚ ì— ì†Œê¸ˆ ì°½ê³ ê°€ ìˆì—ˆëŒ€. ğŸ§‚" },
                    { name: "ë“±ì´Œ", trans: [], desc: "ì¹¼êµ­ìˆ˜ê°€ ë§›ìˆëŠ” ë™ë„¤ì•¼. ğŸœ" },
                    { name: "ì¦ë¯¸", trans: [], desc: "ì´ë§ˆíŠ¸ê°€ ë°”ë¡œ ì˜†ì— ìˆì–´. ğŸ›’" },
                    { name: "ê°€ì–‘", trans: [], desc: "í—ˆì¤€ ì„ ìƒë‹˜ ë°•ë¬¼ê´€ì´ ìˆì–´! ğŸ‘¨â€âš•ï¸" },
                    { name: "ì–‘ì²œí–¥êµ", trans: [], desc: "ì˜›ë‚  í•™êµê°€ ê·¸ëŒ€ë¡œ ë‚¨ì•„ìˆì–´. ğŸ“œ" },
                    { name: "ë§ˆê³¡ë‚˜ë£¨", trans: ["ê³µí•­"], desc: "ì‹ë¬¼ì›ì´ ì•„ì£¼ ë©‹ì§„ ê³³ì´ì•¼! ğŸŒµ" },
                    { name: "ì‹ ë°©í™”", trans: [], desc: "ìƒˆ ì•„íŒŒíŠ¸ë“¤ì´ ì•„ì£¼ ë§ì•„. ğŸ¢" },
                    { name: "ê³µí•­ì‹œì¥", trans: [], desc: "ì‹œì¥ì—ì„œ ë§›ìˆëŠ” ë–¡ë³¶ì´ ë¨¹ì. ğŸ¢" },
                    { name: "ê¹€í¬ê³µí•­", trans: ["5", "ê³µí•­", "ì„œí•´"], desc: "ë¹„í–‰ê¸° íƒ€ê³  ì—¬í–‰ ê°€ì! âœˆï¸" },
                    { name: "ê°œí™”", trans: [], desc: "9í˜¸ì„  ê¸°ì°¨ë“¤ì´ ì ìëŠ” ì§‘ì´ì•¼. ğŸ’¤" }
                ]
            }
        };

        // --- ê²Œì„ ë¡œì§ ---
        let currentLine = null;
        let stationList = [];
        let currentIndex = 0;
        let score = 0;

        // ë…¸ì„  ì„ íƒ í•¨ìˆ˜
        function selectLine(lineId) {
            currentLine = gameData[lineId];
            stationList = currentLine.stations;
            
            // í™”ë©´ ì „í™˜
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('game-header').style.display = 'flex';
            document.getElementById('game-container').style.display = 'flex';
            
            // í…Œë§ˆ ìƒ‰ìƒ ì ìš©
            document.getElementById('game-title').innerText = currentLine.name;
            document.getElementById('game-title').style.color = currentLine.mainColor;
            document.getElementById('game-area').style.borderColor = currentLine.mainColor;
            
            // ë³´ê¸° ë²„íŠ¼ì˜ ìˆ«ì ë°°ê²½ìƒ‰ ë³€ê²½ì„ ìœ„í•œ CSS ë³€ìˆ˜ ì„¸íŒ…ì€ ë³µì¡í•˜ë‹ˆ
            // JSë¡œ ë²„íŠ¼ ìƒì„±ì‹œ ìƒ‰ìƒì„ ì§ì ‘ ë„£ê² ìŠµë‹ˆë‹¤.

            initGame();
        }

        function initGame() {
            currentIndex = 0;
            score = 0;
            updateScore();
            
            document.getElementById('play-screen').style.display = 'block';
            document.getElementById('success-screen').style.display = 'none';
            document.getElementById('message').innerText = "";
            document.getElementById('info-title').innerText = "ì—­ ì´ì•¼ê¸° ğŸ“–";
            document.getElementById('info-text').innerHTML = "ì•ˆë…•? ì§€í•˜ì²  ì—¬í–‰ì„ ë– ë‚˜ë³¼ê¹Œ?<br>ë¬¸ì œë¥¼ ë§ì¶”ë©´ ë‚´ê°€ ì¬ë¯¸ìˆëŠ” ì´ì•¼ê¸°ë¥¼ í•´ì¤„ê²Œ!";

            drawMap();
            loadQuestion();
        }

        function updateScore() {
            document.getElementById('score-board').innerText = `â­ ë§ì¶˜ ê°œìˆ˜: ${score}ê°œ`;
        }

        function drawMap() {
            const mapContainer = document.getElementById('map-container');
            mapContainer.innerHTML = '';

            stationList.forEach((station, index) => {
                const wrapper = document.createElement('div');
                wrapper.className = 'station-wrapper';

                const dot = document.createElement('div');
                dot.className = 'station-dot';
                dot.id = `dot-${index}`;
                // í™œì„±í™”ë  ë•Œ ìƒ‰ìƒì€ CSS currentColor ì‚¬ìš©ì„ ìœ„í•´ style color ì§€ì •
                dot.style.color = currentLine.mainColor; 
                
                // ì´ë¦„ ë° í™˜ìŠ¹ì •ë³´
                const nameDiv = document.createElement('div');
                nameDiv.className = 'station-name';
                nameDiv.id = `name-${index}`;
                nameDiv.innerText = station.name;

                if(station.trans.length > 0) {
                    const badgeContainer = document.createElement('div');
                    badgeContainer.className = 'transfer-badges';
                    station.trans.forEach(line => {
                        const badge = document.createElement('span');
                        badge.className = 'line-badge';
                        badge.style.backgroundColor = lineColors[line] || '#ccc';
                        badgeContainer.appendChild(badge);
                    });
                    nameDiv.appendChild(badgeContainer);
                }

                wrapper.appendChild(dot);
                wrapper.appendChild(nameDiv);
                mapContainer.appendChild(wrapper);
            });
            
            revealStation(0);
        }

        function revealStation(index) {
            const dot = document.getElementById(`dot-${index}`);
            const name = document.getElementById(`name-${index}`);
            if(dot) {
                dot.classList.add('active');
                dot.style.backgroundColor = currentLine.mainColor;
            }
            if(name) name.classList.add('revealed');
        }

        function loadQuestion() {
            if (currentIndex >= stationList.length - 1) {
                gameClear();
                return;
            }

            const currentData = stationList[currentIndex];
            const nextData = stationList[currentIndex + 1];

            document.getElementById('current-station').innerText = currentData.name;
            document.getElementById('current-station').style.color = currentLine.mainColor;
            
            // ë³´ê¸° ìƒì„± (ì •ë‹µ + ì˜¤ë‹µ 2ê°œ)
            let options = [nextData.name];
            
            // ì˜¤ë‹µ í›„ë³´êµ° ë§Œë“¤ê¸° (ë‹¤ë¥¸ ë…¸ì„  ì—­ë“¤ + í˜„ì¬ ë…¸ì„ ì˜ ë‹¤ë¥¸ ì—­ë“¤ ì„ê¸°)
            const otherLineStations = Object.keys(otherStationsDB);
            const currentLineStationNames = stationList.map(s => s.name);
            const allWrongCandidates = [...otherLineStations, ...currentLineStationNames];

            while(options.length < 3) {
                const randomPick = allWrongCandidates[Math.floor(Math.random() * allWrongCandidates.length)];
                // ì •ë‹µ ì•„ë‹˜ & ì´ë¯¸ ë³´ê¸°ì— ì—†ìŒ & í˜„ì¬ ì—­ ì•„ë‹˜
                if(randomPick !== nextData.name && !options.includes(randomPick) && randomPick !== currentData.name) {
                    options.push(randomPick);
                }
            }

            // ë³´ê¸° ì„ê¸°
            options.sort(() => Math.random() - 0.5);

            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';

            options.forEach((optName, idx) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                
                // ë²ˆí˜¸í‘œ ìƒ‰ìƒì„ í˜„ì¬ ë…¸ì„  ìƒ‰ìƒìœ¼ë¡œ
                const numSpan = `<span class="btn-num" style="background-color:${currentLine.mainColor}">${idx+1}</span>`;
                btn.innerHTML = `${numSpan} ${optName}`;
                
                // í´ë¦­ ì´ë²¤íŠ¸
                btn.onclick = () => checkAnswer(optName, nextData, btn);
                
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selectedName, nextData, btnElement) {
            const messageEl = document.getElementById('message');

            if (selectedName === nextData.name) {
                // [ì •ë‹µ]
                messageEl.innerText = "ë”©ë™ëŒ•! ì •ë‹µì…ë‹ˆë‹¤! â­•";
                messageEl.className = "correct";
                score++;
                updateScore();
                currentIndex++;
                revealStation(currentIndex);

                // ì„¤ëª… ì—…ë°ì´íŠ¸
                document.getElementById('info-title').innerText = `${nextData.name}ì—­ ì´ì•¼ê¸° ğŸ“–`;
                document.getElementById('info-text').innerHTML = nextData.desc;

                setTimeout(() => {
                    messageEl.innerText = "";
                    loadQuestion();
                }, 1500);

            } else {
                // [ì˜¤ë‹µ] -> ëª‡ í˜¸ì„ ì¸ì§€ ì•Œë ¤ì£¼ê¸° ë¡œì§
                let feedbackText = "";
                
                // 1. ì˜¤ë‹µ DBì— ìˆëŠ”ì§€ í™•ì¸ (ë‹¤ë¥¸ í˜¸ì„  ì—­)
                if (otherStationsDB[selectedName]) {
                    feedbackText = `(ë•¡! ${otherStationsDB[selectedName]}ì´ì—ìš”)`;
                } 
                // 2. í˜„ì¬ ë…¸ì„  ì•ˆì— ìˆëŠ” ë‹¤ë¥¸ ì—­ì¸ì§€ í™•ì¸
                else {
                    const foundInCurrent = stationList.find(s => s.name === selectedName);
                    if (foundInCurrent) {
                        feedbackText = `(ê°™ì€ ${currentLine.name.split(' ')[0]}ì´ì§€ë§Œ ë‹¤ìŒ ì—­ì€ ì•„ë‹ˆì—ìš”)`;
                    } else {
                        feedbackText = "(ë‹¤ë¥¸ í˜¸ì„  ì—­ì´ì—ìš”)";
                    }
                }

                // ë²„íŠ¼ ì•ˆì— í”¼ë“œë°± í…ìŠ¤íŠ¸ ì¶”ê°€ (ì´ë¯¸ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸)
                let feedbackSpan = btnElement.querySelector('.wrong-feedback');
                if(!feedbackSpan) {
                    feedbackSpan = document.createElement('span');
                    feedbackSpan.className = 'wrong-feedback';
                    btnElement.appendChild(feedbackSpan);
                }
                feedbackSpan.innerText = feedbackText;

                messageEl.innerText = "ì–´? ë‹¤ì‹œ í•œë²ˆ ìƒê°í•´ë³¼ê¹Œ? âŒ";
                messageEl.className = "wrong";
                btnElement.style.backgroundColor = "#fff5f5"; // ì—°í•œ ë¹¨ê°• ë°°ê²½
            }
        }

        function gameClear() {
            document.getElementById('play-screen').style.display = 'none';
            document.getElementById('success-screen').style.display = 'block';
            document.getElementById('success-msg').innerText = `${currentLine.name} ì¢…ì  ë„ì°©! ì •ë§ ëŒ€ë‹¨í•´!`;
            
            document.getElementById('info-title').innerText = "ì¶•í•˜í•´! ğŸ‰";
            document.getElementById('info-text').innerHTML = "ì§€í•˜ì²  ë…¸ì„ ì„ ì „ë¶€ ì™¸ì› êµ¬ë‚˜!<br>ë„ˆëŠ” ì •ë§ ìµœê³ ì˜ ì²™ì²™ë°•ì‚¬ë‹˜ì´ì•¼! ğŸ“";
        }
    </script>
</body>
</html>